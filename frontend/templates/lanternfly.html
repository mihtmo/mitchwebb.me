{% extends "layout.html" %}

{% block title %}

    Spotted Lanternfly

{% endblock title %}


{% block head %}

    <link 
        rel="stylesheet" 
        href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" 
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" 
        crossorigin="" 
    />
    <link 
        rel="stylesheet" 
        href="{{ url_for('static', filename='./css/nouislider.min.css') }}"/>
    <link 
        rel="stylesheet" 
        href="{{ url_for('static', filename='css/qgis2web.css') }}"/>
    <link href="{{ url_for('static', filename='./css/lanternfly.css') }}" rel="stylesheet">

{% endblock head %}


{% block body %}

    <div class="centered">

        <h3>Lanternflies Spotted in North America</h3>

        <div id="observation-map"></div>

        <div id="timeline_info">
            <!-- Default timeline info for slider readouts -->
            <span id='event-start'> First Sighting </span>
            <span id="dash"> - </span>
            <span id='event-end'> Last Sighting </span>
            <span id='event-total'></span>
        </div>

        <div id="map-slider"></div>

        <div id="lanternfly-text" class="textbox">
            <p>
                This map shows sightings of the spotted lanternfly in the continental
                US using data from iNaturalist's API. Drag the sliders to adjust 
                the dates included, or click on the layers button in the top right 
                of the map to view all of the data at once! Due to API restrictions,
                data is updated manually (last updated March 11th, 2024).
                </br> 
                </br>
                </p>
                <span id="more-text">
                    <p>
                        This map is made using 
                        <a 
                            href="https://leafletjs.com/" 
                            target="_blank" 
                            rel="noopener noreferrer">
                                Leaflet
                        </a> 
                        with the help of 
                        <a 
                            href="https://www.qgis.org/en/site/" 
                            target="_blank" 
                            rel="noopener noreferrer">
                                QGIS
                        </a>, 
                        <a 
                            href="https://refreshless.com/nouislider/" 
                            target="_blank" 
                            rel="noopener noreferrer">
                                noUiSlider
                        </a>
                        , and Asymmetrik's 
                        <a 
                            href="https://github.com/Asymmetrik/leaflet-d3" 
                            target="_blank" 
                            rel="noopener noreferrer">
                                Leaflet-D3 Hexbins
                        </a>
                        .
                    </p>
                    <p>
                        The default view is a hexgrid heatmap of sightings in 
                        whatever range of dates you choose. Try making a range of 
                        a few months and scanning through to see the sightings 
                        bloom every fall/winter! The slider date limits update 
                        automatically depending on the bounds of the current data, 
                        and the text in the lower left-hand corner of the map 
                        will let you know how many data points you're including 
                        in the range you've defined.
                    </p>
                    <p>
                        Try changing layers! When switching to the "All Sightings" 
                        layer, every data point is revealed. You can then view 
                        the data for an individual sighting by clicking on the 
                        dot of your interest. From there you can also visit the 
                        original listing on iNaturalist to see images of the 
                        insect and other information about that particular
                        sighting.
                    </p>
                    <p>
                        Thank you for visiting!
                    </p>
                </span>
            <button onclick="readMore()" id="read-more-button" class="button">
                Read More
            </button>
        </div>

    <!-- Functionality for 'read more' button -->
    <!-- TODO: Could be replaced by summary element -->
    <script> 
        function readMore() {
            document.querySelector("#read-more-button").style.display = "none";
            document.querySelector("#more-text").style.display = "block";
        }
    </script>
    <script>
        let lanternflyData = JSON.parse('{{ lanternflyData|tojson|safe }}');
    </script>
    <script src="{{ url_for('static', filename='js/lanternfly/timeArrays.js') }}"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" 
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" 
        crossorigin=""></script>
    <script src="{{ url_for('static', filename='js/lanternfly/leaflet-tilelayer-colorfilter.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/observations.js') }}"></script>
    <script src="https://d3js.org/d3-hexbin.v0.2.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/leaflet-d3.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/mapscript.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/leaflet-hash.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/leaflet.rotatedMarker.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/wNumb.js') }}"></script>
    <script src="{{ url_for('static', filename='./js/lanternfly/nouislider.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/sliderImplementation.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/iso8601-js-period@0.2.1/iso8601.min.js"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/leaflet.timedimension.source.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/qgis2web_expressions.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/rbush.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/labelgun.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/labels.js') }}"></script>
    <script src="{{ url_for('static', filename='js/lanternfly/tailDT.js') }}"></script>

{% endblock body %}


{% block footer %}
<a href="/">home</a>
|
{% endblock footer %}